apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: system
  namespace: argocd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
spec:
  description: System Project
  sourceRepos:
  - {{ .Values.spec.source.repoURL }}
  destinations:
  - namespace: '*'
    server: {{ .Values.spec.destination.server }}
  clusterResourceWhitelist:
  - group: '*'
    kind: '*'
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: system
  namespace: argocd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
spec:
  project: system
  destination:
    server: {{ .Values.spec.destination.server }}
  source:
    path: 02-system
    repoURL: {{ .Values.spec.source.repoURL }}
    targetRevision: {{ .Values.spec.source.targetRevision }}
    values: |
      spec:
        destination:
          server: {{ .Values.spec.destination.server }}
        source:
          repoURL: {{ .Values.spec.source.repoURL }}
          targetRevision: {{ .Values.spec.source.targetRevision }}
